# Предисловие
Этот раздел написан для быстрого вспоминания основных свойств и формул, я постарался изложить все математически строго на основе лекций по аналитической механике Холостовой (https://www.youtube.com/watch?v=sS02OkFaUG0&list=PLthfp5exSWEqlLfwHOTMo51HUR6pIgbid&index=5 и https://www.youtube.com/watch?v=OOSWfY-hR_o&list=PLthfp5exSWEqlLfwHOTMo51HUR6pIgbid&index=6)и еще некоторых материалов (например, https://www.youtube.com/playlist?list=PLmu_y3-DV2_k-Tnu_L-uZ8FMbTWGce-ED).
Также это все будет применено непосредственно в моем дипломе по трикоптеру.
```
Неоднозначная вставка:
Основным преимуществом кватернионов перед матрицами поворота (даже вокруг произвольной оси) является интерполяция, а именно представим, что мы отметили несколько ключевых точек, которые хотим посетить. Пусть переходы между точками задаются различными матрицами поворота вокруг произвольной оси. В такой матрице есть несколько параметров: ось и угол поворота. Поэтому можно сделать анимацию прохождения этих ключевых точек, равномерно меняя угол от $0$ до требуемого (а какие есть еще идеи?). Ожидаем мы, конечно, что тело и впрямь будет осуществлять простой поворот вокруг указанной оси и все промежуточные положения будут на траектории кратчайшего поворота между 2-мя соседними ключевыми ориентациями. Но так не произойдет, да, в ключевых точках ориентацию будет точно та, которую мы ожидаем, но в промежуточных точках будет очень замысловатая и неестественная кривая. Почему? Потому что матрица поворота довольно сложным образом складывает различные проекции осей с разными коэффициентами
```
# Теория кватернионов
## Введение кватернионов как объектов
Кватернион – гиперкомплексное число, которое можно представить следующим образом:
$$\Lambda=\lambda_0 + \lambda_1\vec{i}+\lambda_2\vec{j}+\lambda_3\vec{k} \in \mathbb{H},$$
или, что эквивалентно:
$$\Lambda=\lambda_0\vec{i_0} + \lambda_1\vec{i_1}+\lambda_2\vec{i_2}+\lambda_3\vec{i_3} \in \mathbb{H}.$$
Это также можно записать в другом виде:
$$\Lambda=\lambda_0+\vec{\lambda}, \text{ где }\vec{\lambda}= \left( \begin{matrix} \lambda_1 \\ \lambda_2 \\ \lambda_3 \\ \end{matrix} \right) \text{ – вектор в}$$ $$\text{трехмерном гиперкомплексном пространстве, заданный в каком-то базисе.}$$
В связи с тем, что $\vec{\lambda}$ мы полагаем вектором, уместно напомнить, что у вектора есть модуль, равный $\left|\vec{\lambda}\right|=\sqrt{\lambda_1^2+\lambda_2^2+\lambda_3^2}.$
## Свойства кватернионов
1. Сложение $+$
	Пусть $\Lambda=\lambda_0 + \left( \begin{matrix} \lambda_1 \\ \lambda_2 \\ \lambda_3 \\ \end{matrix} \right),\text{M}= \mu_0 + \left( \begin{matrix} \mu_1 \\ \mu_2 \\ \mu_3 \\ \end{matrix} \right) \in \mathbb{H}$, тогда$$\Lambda+\text{M}=(\lambda_0+\mu_0)+\left(\vec{\lambda}+\vec{\mu}\right)=(\lambda_0+\mu_0)+\left( \begin{matrix} \lambda_1+\mu_1 \\ \lambda_2+\mu_2 \\ \lambda_3+\mu_3 \\ \end{matrix} \right),$$
	т.е. сложение происходит поэлементно.	
2. Умножение базисных векторов $\circ$
	- $\vec{i_0} \circ \vec{i_0}=1, \quad \vec{i_0} \circ \vec{i_k}= \vec{i_k} \circ \vec{i_0} = \vec{i_k} \qquad(k=1,2,3),$
	- $\vec{i_k} \circ \vec{i_k} = -1 \qquad (k=1,2,3), \quad \vec{i_1} \circ \vec{i_2} = \vec{i_3}, \quad \vec{i_2} \circ \vec{i_3} = \vec{i_1}, \quad \vec{i_3} \circ \vec{i_1} = \vec{i_2},$
	- $\vec{i_k} \circ \vec{i_l} = -\vec{i_l} \circ \vec{i_k}, \qquad (k \neq l,k,l=1,2,3).$
	$\vec{i_0}=1$ – вещественная единица,
	$\vec{i_1},\vec{i_2},\vec{i_3}$ – правая тройка единичных векторов (мнимых единиц).$$\vec{i_k}\circ\vec{i_l}=\vec{i_k}\times\vec{i_l}-\vec{i_k}\cdot\vec{i_l}, \qquad (k,l=1,2,3)$$
	Кстати, $\vec{i}\circ\vec{j}\circ\vec{k}=\vec{i_1}\circ\vec{i_2}\circ\vec{i_3}=\vec{i_1}\circ\vec{i_1}=-1.$
1. Дистрибутивность *(Аксиома)*
	- $\left(\Lambda + \text{M} \right) \circ \text{N} = \Lambda \circ \text{N} + \text{M} \circ \text{N}.$
	- $\text{N} \circ \left(\Lambda + \text{M} \right) = \text{N} \circ \Lambda + \text{N} \circ \text{M}.$
2. Некоммутативность
	$\Lambda\circ\text{M}-\text{M}\circ\Lambda=2\vec{\lambda} \times \vec{\mu} \ne 0.$
3. Умножение 2-х кватернионов $\circ$
	Векторные части 2-х кватернионов умножаются так же, как в свойстве $2^{\circ}$:$$\vec{\lambda} \circ \vec{\mu} = \vec{\lambda}\times\vec{\mu}-\vec{\lambda}\cdot\vec{\mu}.$$
	Тогда кватернионное умножение вводится следующим образом:$$\Lambda \circ \text{M}=\lambda_0\mu_0+\lambda_0\vec{\mu}+\mu_0\vec{\lambda}+\underbrace{\vec{\lambda} \circ \vec{\mu}}_{\vec{\lambda}\times\vec{\mu}-\vec{\lambda}\cdot\vec{\mu}}=\left( \lambda_0\mu_0-\vec{\lambda} \cdot \vec{\mu} \right) + \left(\lambda_0\vec{\mu}+\mu_0\vec{\lambda} + \vec{\lambda} \times \vec{\mu} \right).$$
	**Важные частные случаи:**
	- $\Lambda \circ \Lambda = \Lambda^2=\lambda_0^2-\left|\vec{\lambda}\right|^2+2\lambda_0\vec{\lambda},$
	- $\vec{\lambda} \circ \vec{\mu} = \vec{\lambda}\times\vec{\mu}-\vec{\lambda}\cdot\vec{\mu},$
	- $\vec{\lambda}\circ\vec{\lambda}=-\vec{\lambda}\cdot\vec{\lambda}=-\left|\vec{\lambda}\right|^2.$
4.  Ассоциативность (Доказывается)
	$\left(\Lambda\circ\text{M}\right)\circ\text{N}=\Lambda\circ\left(\text{M}\circ\text{N}\right).$
### Сопряженный кватернион $\widetilde{\Lambda}$
$$
\Lambda=\lambda_0+\vec{\lambda},\text{ тогда сопряженный кватернион } \widetilde{\Lambda}=\lambda_0-\vec{\lambda}.
$$
Свойства:
$$
\mathrm{\widetilde{\Lambda\circ M}=\widetilde{M} \circ \widetilde{\Lambda}\Rightarrow \qquad \widetilde
{\Lambda_1\circ \dots \circ\Lambda_n}=\widetilde{\Lambda}_n\circ \dots \circ \widetilde{\Lambda}_1}
$$
### Норма кватерниона $\|\Lambda\|$
Она равна $$\|\Lambda\|=\Lambda \circ \widetilde{\Lambda}=\widetilde{\Lambda}\circ\Lambda=\left(\lambda_0+\vec{\lambda}\right)\circ\left(\lambda_0-\vec{\lambda}\right)=\lambda_0^2-\underbrace{\vec{\lambda}\circ\vec{\lambda}}_{\left|\vec{\lambda}\right|}=\lambda_0^2+\left|\vec{\lambda}\right|^2=\sum_{k=0}^3{\lambda_k^2}.$$
Если $\|\Lambda \| = 1$, то кватернион называется *нормированным*.
Свойства:
$$\|\Lambda\circ\text{M}\|=\|\Lambda\|\circ\|\text{M}\|.$$
### Обратный кватернион $\Lambda^{-1}$
Это такой кватернион, что выполняется
$$\Lambda\circ\Lambda^{-1}=\Lambda^{-1}\circ\Lambda=1.$$
Формула получения обратного кватерниона.
Домножаем требуемое равенство на сопряженный кватернион слева:
$$\widetilde{\Lambda}\circ\left|\Lambda\circ\Lambda^{-1}=1\right.$$
$$\underbrace{\left(\widetilde{\Lambda}\circ\Lambda\right)}_{\|\Lambda\|}\circ\Lambda^{-1}=\widetilde{\Lambda}. \quad \Rightarrow \quad \Lambda^{-1}=\frac{\widetilde{\Lambda}}{\|\Lambda\|}$$
### Модуль кватерниона $\left|\mathrm{\Lambda}\right|$
Он равен $$\left|\Lambda \right|=\sqrt{\|\Lambda \|}=\sqrt{\lambda_0^2+\lambda_1^2+\lambda_2^2+\lambda_3^2}.$$
Если $\|\Lambda\|=1$, то $\Rightarrow \quad \Lambda^{-1}=\widetilde{\Lambda}$.
### Тригонометрическая форма записи кватерниона
- Нормированный
	$\Lambda=\lambda_0+\vec{\lambda}, \quad \lambda_0^2+\left|\vec{\lambda}\right|^2=1;$
	$\vec{e}=\frac{\vec{\lambda}}{\left|\vec{\lambda}\right|};$$$\Lambda=\cos{\varphi}+\vec{e}\sin{\varphi}.$$
- Ненормированный
	$$\Lambda=\left|\Lambda\right|\left(\cos{\varphi}+\vec{e}\sin{\varphi}\right).$$
#### Выражение произведения кватернионов с коллинеарными векторными частями
$$\Lambda=\left|\Lambda\right|\left(\cos{\varphi}+\vec{e}\sin{\varphi}\right).$$
$$\mathrm{M=\left|M\right|\left(\cos{\varphi}+\vec{e}\sin{\varphi}\right).}$$
$$\mathrm{\Lambda\circ M=|\Lambda||M|(\cos{\varphi}\cos{\psi}+\vec{e}\left(\cos{\varphi}\sin{\psi}+\sin{\varphi}\cos{\psi}\right) + \underbrace{\vec{e}\circ\vec{e}}_{-1}\sin{\varphi}\sin{\psi}}.$$
$$\underset{\Downarrow}{\mathrm{\Lambda\circ M=|\Lambda||M|\left(\cos{(\varphi+\psi)}+\vec{e}\sin{(\varphi+\psi)}\right)}}.$$
Аналог формулы Муавра:
$$\Lambda^n=|\Lambda|^n\left(\cos{(n\varphi)}+\vec{e}\sin{(n\varphi)}\right).$$

# Применение кватернионов к описанию вращения твердого тела

Есть твердое тело в *неподвижной абсолютной* системе координат $I$ (далее с.к.), с которым связана *подвижная* с.к. $E$:
$$OXYZ\text{ – неподвижная с.к. (}I,\text{ орты }\vec{i_1},\vec{i_2},\vec{i_3}),$$
$$Oxyz\text{ – подвижная с.к. (}E,\text{ орты }\vec{e_1},\vec{e_2},\vec{e_3}).$$
![[Source/Твердое тело.png#center|450]]

>[!Th] Теорема 1
>Существует нормированный кватернион $\Lambda$, при помощи которого связь между ортами систем координат $I$ и $E$ определяется соотношениями $$\vec{e}_k=\Lambda \circ \vec{i}_k \circ \widetilde{\Lambda} \quad (k=1,2,3).\qquad (\vec{e}_k\text{ и } \vec{i}_k \text{ записаны в базисе }I)$$
>Этим соотношениям удовлетворяет 2 нормированных кватерниона, отличающихся знаками.

>[!proof]- Доказательство
>

Из этой теоремы следует, что если есть связанная с твердым телом точка $P$, при этом само тело вращается вместе со связанной системой координат $E$ $\left(\overrightarrow{OP}\text{ – вектор из }O\text{ в неподвижную относительно твердого тела точку }P\text{ (Эта точка неподвижна в системе координат }E\text{), заданный в системе координат }I\right),$
и в начальный момент времени $t=0$ базисы совпали: $E=I$,
$\vec{r}$ – начальное положение точки $P$    $\left(\overrightarrow{OP}\text{ в }I\right)$,
$\vec{r'}$ – текущее положение точки $P$    $\left(\overrightarrow{OP}\text{ в }I\right)$,
то
$$\overrightarrow{r'} = \Lambda \circ \vec{r} \circ \widetilde{\Lambda}. \qquad{(\text{В базисе }I)}$$
>[!proof]+ Доказательство
>Фиксируем положение точки $P$ в момент времени $t=0$:
>$$\vec{r}=\left(\begin{matrix}\vec{i}_1 & \vec{i}_2 & \vec{i}_3 \\\end{matrix}\right) \cdot \left(\begin{matrix}\xi_1\\\xi_2\\\xi_3\\\end{matrix}\right)=\sum_{k=1}^3{\vec{i}_k\cdot\xi_k}$$
>$$\qquad\Lambda \circ \downarrow \circ \widetilde{\Lambda}\qquad \text{Теорема 1}$$
>$$\Lambda \circ \vec{r}\circ\widetilde{\Lambda}=\sum_{k=1}^3{\vec{e}_k\cdot\xi_k}$$
>– вектор, полученный вращением $\vec{r}$ (имеет координаты точки $P$ в момент времени $t=0$, отложенные в повернутом базисе $E$).
>$$\Downarrow$$
>$$\overrightarrow{r'}=\Lambda\circ\vec{r}\circ\widetilde{\Lambda}.$$
>Важно заметить: чтобы умножения вектора на кватернион проходило быстро и удобно, $\Lambda$ должен быть записан в базисе $I$, иначе при раскрытии скобок появятся слагаемые, содержащие что-то вроде $\vec{i_k}\circ\vec{i'_k}$ которые не очень приятно считать (т.е. как такового запрета нет, просто это неудобно до невозможности).

Есть и еще 1 следствие: если имеется какой-то вектор $\vec{r}$, координаты которого записаны в подвижном базисе $E$: $\left(\begin{matrix}\xi'_1 \\ \xi'_2 \\ \xi'_3 \\ \end{matrix}\right)$, а нам нужен этот вектор, но разложенный в исходном базисе $I$, то 
$$\vec{r}=\underset{?}{\sum_{k=1}^3{\underset{\|}{\xi_k}\cdot\vec{i_k}}}=\sum_{k=1}^3{\xi'_k\cdot\vec{e_k}}\stackrel{Th.1}{=}\sum_{k=1}^3{\xi'_k\cdot\Lambda\circ\vec{i_k}\circ\widetilde{\Lambda}}=\Lambda\circ\left(\sum_{k=1}^3{\xi'_k\cdot\vec{i_k}}\right)\circ\widetilde{\Lambda}.$$
Обозначим $\vec{r}_E=\sum\limits_{k=1}^3{\xi'_k\cdot\vec{i_k}}$ – вектор c компонентами из связанного с твердым телом базиса $E$, которые отложили по осям $I$.
Тогда чтобы получить компоненты вектора $\vec{r}$ в неподвижном базисе $I$, требуется сконструировать вектор $\vec{r}_E$ с компонентами из подвижного базиса $E$, но с направляющими векторами базиса $I$ и домножить его на кватернион, связывающий 2 базиса из теоремы 1, и сопряженный ему кватернион слева и справа соответственно:
$$\vec{r}=\Lambda\circ\vec{r}_E\circ\widetilde{\Lambda}$$
>[!Th] Теорема Эйлера о конечном повороте (Теорема 2)
>Произвольное положение тела с неподвижной точкой может быть получено из его начального положения путем 1-го поворота вокруг оси, задаваемой вектором $\vec{e}=\frac{\vec{\lambda}}{\left|\vec{\lambda}\right|}$, на угол $\theta=2\arccos{\lambda_0}$.
>Для поворота достаточно выполнить следующую операцию:
>$$\vec{r'} = \Lambda \circ \vec{r} \circ \widetilde{\Lambda}.$$
>Кватернион для такого поворота задается так:
>$$\Lambda = \lambda_0+\vec{\lambda}=\cos{\frac{\theta}{2}}+\vec{e}\sin{\frac{\theta}{2}}.$$
>По сути теорема *расшифровывает* кватернион, ставя ему в соответствие некоторый поворот.

>[!proof]- Доказательство
>Потом мб напишу

>[!Example] 2 поворота
>$$\underset{(\vec{i}_k)}{I} \underset{\Lambda}{\longrightarrow} \underset{(\vec{i}'_k)}{I'} \underset{\text{M}}{\longrightarrow} \underset{(\vec{i}''_k)}{I''}$$
>$$I\underset{\text{N}}{\longrightarrow} I''$$
>$$\overrightarrow{r''}=\text{M}\circ\vec{r'}\circ\widetilde{\text{M}}=\left(\text{M}\circ\Lambda\right) \circ \vec{r} \circ (\widetilde{\Lambda}\circ\widetilde{\text{M}} )=\underbrace{\left(\text{M}\circ\Lambda\right)}_{\text{N}} \circ \vec{r} \circ \underbrace{(\widetilde{\text{M}\circ\Lambda} )}_{\widetilde{N}}$$
>$$\text{N}=\text{M}\circ\Lambda.$$
>Чтобы все это было удобно считать, аналогично замечанию выше на каждом шаге векторы и кватернионы записываются в 1-м базисе!
>Т.е. если, к примеру, $\vec{r}$ записан в $I$, то для применимости такой формулы 1-й поворот осуществляется кватернионом $\Lambda$, записанным в $I$, получится вектор $\overrightarrow{r'}=\Lambda\circ\vec{r}\circ\widetilde{\Lambda}$ в базисе $I$, тогда при переходе от него к $\overrightarrow{r''}$ требуется поворот, записанный в $\text{M}$, но ведь мы все еще вращаем вектор в $I$, поэтому угол поворота и ось вращения должны быть записаны в этом же базисе!

>[!Th] $n$ поворотов
>Если имеется $n$ последовательных поворотов, описываемых следующей группой кватернионов: $\Lambda_1,\dots,\Lambda_n$ (записанных в 1-м базисе), то
>итоговый 1 поворот опишется перемножением этих кватернионов в обратном порядке:
>$$\Lambda = \Lambda_n \circ \dots \circ \Lambda_1.$$
>

На практике запись последовательных поворотов удобна не в такой форме, а в форме, где повороты в каждом кватернионе записаны относительно предыдущего базиса, т.е. в том базисе, который он преобразует. В примере выше 2-й поворот $\text{M}$ задавался бы поворотом внутри базиса $I'$, а 1-й поворот – в базисе $I$, т.е. в базисе, который он непосредственно преобразует.

## Собственный кватернион
Параметры кватерниона, записанные в базисе, который он непосредственно преобразует, называются параметрами ***Родрига-Гамильтона***.
Рассмотрим 2 последовательных поворота из примера выше.
Запишем кватернионы в базисах, которые они непосредственно преобразуют (компоненты, имеющие индекс $*$, вместе с базисными векторами, на которые они домножаются, в сумме образуют ось вращения, заданную в том же базисе):
$$\Lambda=\lambda_0+\underbrace{\sum_{k=1}^3{\lambda_k\cdot\vec{i}_k}}_{\displaylines{\text{Ось в исходном} \\ \text{ базисе}}}=\lambda_0+\sum_{k=1}^3{\lambda_k^*\cdot\vec{i}_k},$$
$$\text{M}=\mu_0+\underbrace{\sum_{k=1}^3{\mu_k\cdot\vec{i}_k}}_{\displaylines{\text{Ось в исходном} \\ \text{ базисе}}} = \mu_0+\sum_{k=1}^3{\mu_k^*\cdot\vec{i'}_k}$$
$$\text{N}=\nu_0+\underbrace{\sum_{k=1}^3{\nu_k\cdot\vec{i_k}}}_{\displaylines{\text{Ось в исходном} \\ \text{ базисе}}}=\nu_0+\sum_{k=1}^3{\nu_k^*\cdot\vec{i}_k},$$
$$\lambda_k^*, \mu_k^*,\nu_k^* \text{ – параметры Родрига-Гамильтона.}$$
Таким образом, $\Lambda$ задан в $I$, а $\lambda_k^*$ задают ось вращения тоже в $I$,
$\text{M}$ задан в $I'$, а $\mu_k^*$ задают ось вращения тоже в $I'$,
$\text{N}$ задан в $I$, а $\nu_k^*$ задают ось вращения тоже в $I$.
Такое задание кватернионов можно назвать удобным.

Однако для удобного перемножения по формуле выше требуется знать параметры разложения промежуточных осей вращения в базисе $I$: $\lambda_k,\mu_k$.

Попробуем перемножить кватернионы $\Lambda$ и $\text{M}$ по схеме выше, чтобы получить итоговый поворот, записанный в $\text{N}$ (формула выше работает для любых базисов, но сейчас я продемонстрирую, что могло бы быть, если бы использовались кватернионы в различных базисах):
$$\text{N}=\text{M}\circ\Lambda=\left(\mu_0+\sum_{k=1}^3{\mu_k^*\cdot\vec{i'_k}}\right)\circ\Lambda = \left(\mu_0+\sum_{k=1}^3{\mu_k^*\cdot\Lambda\circ\vec{i_k}\circ\widetilde{\Lambda}}\right)\circ\Lambda =$$
$$ \mu_0\Lambda+\sum_{k=1}^3{\mu_k^*\Lambda\circ\vec{i_k}\circ} \underset{\|\Lambda\|=1 \quad\text{(Все наши кватернионы нормированы)}}{\underbrace{\widetilde{\Lambda}\circ\Lambda}_{} =\Lambda\mu_0+\sum_{k=1}^3{\Lambda\circ\mu_k^*\vec{i_k}} = \Lambda\mu_0}+\Lambda\circ\sum_{k=1}^3{\mu_k^*\vec{i_k}}=$$
$$\underset{\qquad \qquad \qquad \quad\text{M}^* \text{ – собственный кватернион}}{=\Lambda\circ\underbrace{\left(\mu_0+\sum_{k=1}^3{\mu_k^*\cdot\vec{i_k}}\right)}=\Lambda\circ\text{M}^*}.$$
>[!def] Собственный кватернион
> **Собственный кватернион** – это кватернион, компоненты которого являются параметрами Родрига-Гамильтона, а базисные векторы – исходные базисные векторы начального базиса.

Обратим внимание на то, что $\Lambda^*=\Lambda$ и $\text{N}=\text{N}^*$, т.к. они преобразуют исходный базис $I$.
Тогда получим, что
$$\text{N}=\text{N}^*=\Lambda^*\circ\text{M}^*,$$
т.е. собственные кватернионы мало того, что удобны в составлении, так еще и перемножаются в прямом порядке! (Кстати, они все разложены в базисе $I$ с компонентами Родрига-Гамильтона, т.е. компонентами кватернионов в базисах, которые они непосредственно преобразуют.)

Тогда получаем формулу для $n$ поворотов:
>[!Th] n поворотов
>Если имеется $n$ последовательных поворотов, описываемых следующей группой собственных кватернионов: $\Lambda_1^*,\dots,\Lambda_n^*$ (компоненты составлены в базисах, которые они преобразуют), то итоговый 1 поворот опишется перемножением этих кватернионов в прямом порядке:
>$$\Lambda=\Lambda^* = \Lambda_1^* \circ \dots \circ \Lambda_n^*.$$
>А т.к. $\Lambda^*$ разложен в исходном базисе, то для поворота $\vec{r}$ достаточно выполнить следующую операцию:
>$$\vec{r'} = \Lambda^* \circ \vec{r} \circ \widetilde{\Lambda^*}.$$

# Уравнение Пуассона. Угловая скорость твердого тела
Например, требуется осуществить следующий переход:
$$I \underset{\Lambda(t)}{\longrightarrow} E(t) \underset{\delta\Lambda(t,\Delta t)}{\longrightarrow} E(t+\Delta t).$$
Тогда введем кватернион $\Lambda(t+\Delta t)$, задающий переход
$$I\underset{\Lambda(t+\Delta t)}{\longrightarrow} E(t+\Delta t).$$
По теореме о $n$ последовательных поворотах получим, что 
$$\Lambda(t+\Delta t) = \delta \Lambda\circ\Lambda.$$
Запишем $\delta \Lambda$ в тригонометрической форме:
$$\delta\Lambda=\overset{\qquad\qquad\qquad\qquad\text{мал }\Rightarrow \text{ по Тейлору}}{\cos{\frac{\Delta\varphi}{2}}+\vec{e}\sin{\overset{/}{\frac{\Delta\varphi}{2}}}\approx 1+\frac{1}{2}\vec{e}\Delta \varphi.}$$
Тогда
$$\left.\Lambda(t+\Delta t)-\Lambda(t)=\delta\Lambda\circ\Lambda-\Lambda\approx \left(1+\frac{1}{2}\vec{e}\Delta\varphi\right)\circ\Lambda-\Lambda=\frac{1}{2}\vec{e}\Delta\varphi\circ \Lambda\qquad  \right|:\Delta t, \Delta t \rightarrow 0$$
$$\underset{\qquad\qquad\qquad\qquad\qquad\qquad\qquad\vec{\omega}\text{ – вектор угловой скорости твердого тела}}{\dot{\Lambda}=\frac{1}{2}\underbrace{\lim_{\Delta t \rightarrow 0}{\frac{\Delta \varphi}{\Delta t}}\vec{e}}\circ\Lambda,}$$
$$\dot{\Lambda}=\frac{1}{2}\vec{\omega}\circ\Lambda\quad \text{ – }\quad \text{Уравнение Пуассона.}$$
Еще 1 форма **уравнения Пуассона** (получена домножением справа на $\widetilde{\Lambda}$):
$$\vec{\omega}=2\dot{\Lambda}\circ\widetilde{\Lambda}.$$
Однако на практике вектор угловой скорости $\vec{\omega}$ задан в связанном с твердым телом базисе $E$ $\vec{\omega}^E$. (Обозначим вектор угловой скорости в исходном базисе $I$ как $\vec{\omega}^I$.) Тогда
$$\vec{\omega}^I=\Lambda\circ\vec{\omega}^E\circ\widetilde{\Lambda},$$
тогда
$$\dot{\Lambda}=\frac{1}{2}\Lambda\circ\vec{\omega}^E\circ \underset{\|\Lambda\|=1}{\underbrace{\widetilde{\Lambda}\circ\Lambda}}.$$
$$\dot{\Lambda}=\frac{1}{2}\Lambda\circ\vec{\omega}^E.$$
Это можно было бы получить, используя вывод с параметрами Родрига-Гамильтона.
Это уравнение Пуассона, позволяющее отслеживать ориентацию тела итеративно:
0. Задаем начальный кватернион $\Lambda(0)$;
1. Вычисляем $\dot{\Lambda}(t)=\frac{1}{2}\Lambda(t)\circ\vec{\omega}^E(t);$
2. Вычисляем новый кватернион $\Lambda(t+\Delta t)=\Lambda(t)+\dot{\Lambda}(t)\Delta t$.

#Робототехника